(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{347:()=>{},1011:(e,t,r)=>{"use strict";r.d(t,{P:()=>n,j:()=>i});var a=r(5155),o=r(2115),s=r(8260);let l=(0,o.createContext)(void 0);function n(e){let{children:t}=e,[r,n]=(0,o.useState)(null),[i,c]=(0,o.useState)(""),[u,d]=(0,o.useState)(0),[p,f]=(0,o.useState)(0),[m,y]=(0,o.useState)({}),[k,h]=(0,o.useState)(!1),[w,b]=(0,o.useState)([]),{saveWorkflowState:C,clearWorkflowState:g,loadWorkflowState:S}=function(e){let{workflowId:t,workflowType:r,currentStep:a,totalSteps:l,data:n,autoSaveInterval:i=3e3}=e,c=(0,o.useRef)(""),u=(0,o.useRef)(),d=(0,o.useCallback)(async e=>{try{let r=localStorage.getItem("ntu-workflow-state"),a=r?JSON.parse(r):{};a[t]=e,localStorage.setItem("ntu-workflow-state",JSON.stringify(a)),console.log("Auto-saved workflow ".concat(t," at step ").concat(e.currentStep))}catch(e){console.error("Failed to auto-save workflow:",e),s.oR.error("Failed to auto-save progress")}},[t]),p=(0,o.useCallback)(()=>{try{let e=localStorage.getItem("ntu-workflow-state");if(e){let r=JSON.parse(e);delete r[t],localStorage.setItem("ntu-workflow-state",JSON.stringify(r))}}catch(e){console.error("Failed to clear workflow state:",e)}},[t]),f=(0,o.useCallback)(()=>{try{let e=localStorage.getItem("ntu-workflow-state");if(e)return JSON.parse(e)[t]||null}catch(e){console.error("Failed to load workflow state:",e)}return null},[t]);return(0,o.useEffect)(()=>{let e=JSON.stringify({currentStep:a,data:n});return e!==c.current&&(u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{d({id:t,type:r,currentStep:a,totalSteps:l,data:n,lastSaved:new Date().toISOString()}),c.current=e},i)),()=>{u.current&&clearTimeout(u.current)}},[t,r,a,l,n,i,d]),{saveWorkflowState:d,clearWorkflowState:p,loadWorkflowState:f}}({workflowId:r||"",workflowType:i,currentStep:u,totalSteps:p,data:m}),v=function(){let[e,t]=(0,o.useState)([]),[r,a]=(0,o.useState)(!1),l=(0,o.useCallback)((e,t,r,a)=>({id:"error-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e,message:t,step:r,timestamp:new Date().toISOString(),recoverable:"permission"!==e,retryCount:0,maxRetries:"network"===e?3:"processing"===e?2:1,context:a}),[]),n=(0,o.useCallback)(e=>{t(t=>[...t,e]),s.oR.error("Error in ".concat(e.step,": ").concat(e.message),{duration:5e3,id:e.id})},[]),i=(0,o.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e)),s.oR.dismiss(e)},[]),c=(0,o.useCallback)(async(r,o)=>{let l=e.find(e=>e.id===r);if(!l||l.retryCount>=l.maxRetries)return!1;a(!0);try{return t(e=>e.map(e=>e.id===r?{...e,retryCount:e.retryCount+1}:e)),await o(),i(r),s.oR.success("Retry successful for ".concat(l.step)),!0}catch(a){let e={...l,retryCount:l.retryCount+1,message:a instanceof Error?a.message:"Retry failed"};return t(t=>t.map(t=>t.id===r?e:t)),e.retryCount>=e.maxRetries&&s.oR.error("Max retries reached for ".concat(l.step)),!1}finally{a(!1)}},[e,i]),u=(0,o.useCallback)((e,t,r,a,o)=>{let s=[];return e.recoverable&&e.retryCount<e.maxRetries&&s.push({type:"retry",label:"Retry (".concat(e.retryCount,"/").concat(e.maxRetries,")"),description:"Try the failed step again",handler:()=>c(e.id,t),primary:!0}),s.push({type:"rollback",label:"Go Back",description:"Return to the previous step",handler:r}),a&&"validation"!==e.type&&s.push({type:"skip",label:"Skip Step",description:"Continue without completing this step",handler:()=>{i(e.id),a()}}),s.push({type:"exit",label:"Exit Workflow",description:"Cancel and return to dashboard",handler:()=>{o&&o(),i(e.id)}}),s},[c,i]),d=(0,o.useCallback)(async(e,t,r)=>{try{let t=await e();return{success:!0,data:t}}catch(s){let e="unknown",a="An unexpected error occurred";s instanceof Error&&(e=(a=s.message).includes("network")||a.includes("fetch")?"network":a.includes("timeout")?"timeout":a.includes("permission")||a.includes("unauthorized")?"permission":a.includes("validation")||a.includes("invalid")?"validation":"processing");let o=l(e,a,t,r);return n(o),{success:!1,error:o}}},[l,n]),p=(0,o.useCallback)(()=>{e.forEach(e=>s.oR.dismiss(e.id)),t([])},[e]),f=(0,o.useCallback)(()=>{let t=e.length,r=e.filter(e=>!e.recoverable||e.retryCount>=e.maxRetries).length;return{total:t,critical:r,retryable:e.filter(e=>e.recoverable&&e.retryCount<e.maxRetries).length,hasErrors:t>0,canProceed:0===r}},[e]);return{errors:e,isRecovering:r,addError:n,removeError:i,retryError:c,getErrorActions:u,handleAsyncOperation:d,clearAllErrors:p,getErrorSummary:f,createError:l}}(),E=(0,o.useCallback)((e,t,r)=>{n(e),c(t),b(r),f(r.length),d(0),y({}),h(!1),v.clearAllErrors()},[v]),R=(0,o.useCallback)(()=>{u<p-1&&d(e=>e+1)},[u,p]),x=(0,o.useCallback)(()=>{u>0&&d(e=>e-1)},[u]),O=(0,o.useCallback)(e=>{y(t=>({...t,...e}))},[]),N=(0,o.useCallback)(()=>{r&&g(),n(null),c(""),d(0),f(0),y({}),b([]),h(!1),v.clearAllErrors()},[r,g,v]),P=(0,o.useCallback)(()=>{N()},[N]),A={currentWorkflow:r,currentStep:u,totalSteps:p,workflowData:m,isLoading:k,startWorkflow:E,nextStep:R,previousStep:x,updateWorkflowData:O,finishWorkflow:N,cancelWorkflow:P,resumeWorkflow:(0,o.useCallback)(e=>{n(e.id),c(e.type),d(e.currentStep),f(e.totalSteps),y(e.data)},[]),steps:w,errors:v.errors,isRecovering:v.isRecovering,handleAsyncOperation:v.handleAsyncOperation,addError:v.addError,removeError:v.removeError,clearAllErrors:v.clearAllErrors,getErrorSummary:v.getErrorSummary};return(0,a.jsx)(l.Provider,{value:A,children:t})}function i(){let e=(0,o.useContext)(l);if(void 0===e)throw Error("useWorkflow must be used within a WorkflowProvider");return e}},6503:(e,t,r)=>{"use strict";r.d(t,{Providers:()=>p});var a=r(5155),o=r(2922),s=r(6715),l=r(1362),n=r(8260),i=r(2115),c=r(5695),u=r(1011);let d=new o.E;function p(e){let{children:t}=e,r=(0,c.useRouter)();return(0,i.useEffect)(()=>{function e(e){(e.metaKey||e.ctrlKey)&&"m"===e.key&&(e.preventDefault(),r.push("/"))}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[r]),(0,a.jsx)(s.Ht,{client:d,children:(0,a.jsx)(l.N,{attribute:"class",defaultTheme:"system",enableSystem:!0,disableTransitionOnChange:!0,children:(0,a.jsxs)(u.P,{children:[(0,a.jsx)(n.l$,{position:"bottom-right"}),t]})})})}},7959:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,8346,23)),Promise.resolve().then(r.t.bind(r,347,23)),Promise.resolve().then(r.bind(r,6503))}},e=>{e.O(0,[838,260,924,441,964,358],()=>e(e.s=7959)),_N_E=e.O()}]);