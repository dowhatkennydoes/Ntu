(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1627:function(e,t,r){Promise.resolve().then(r.t.bind(r,9974,23)),Promise.resolve().then(r.t.bind(r,2778,23)),Promise.resolve().then(r.bind(r,8483))},2935:function(e,t,r){"use strict";r.d(t,{b:function(){return l},D:function(){return i}});var n=r(7437),a=r(2265),o=r(6175);let s=(0,a.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,a.useState)(null),[i,c]=(0,a.useState)(""),[u,d]=(0,a.useState)(0),[f,m]=(0,a.useState)(0),[p,y]=(0,a.useState)({}),[k,h]=(0,a.useState)(!1),[w,b]=(0,a.useState)([]),{saveWorkflowState:C,clearWorkflowState:S,loadWorkflowState:g}=function(e){let{workflowId:t,workflowType:r,currentStep:n,totalSteps:s,data:l,autoSaveInterval:i=3e3}=e,c=(0,a.useRef)(""),u=(0,a.useRef)(),d=(0,a.useCallback)(async e=>{try{let r=localStorage.getItem("ntu-workflow-state"),n=r?JSON.parse(r):{};n[t]=e,localStorage.setItem("ntu-workflow-state",JSON.stringify(n)),console.log("Auto-saved workflow ".concat(t," at step ").concat(e.currentStep))}catch(e){console.error("Failed to auto-save workflow:",e),o.Am.error("Failed to auto-save progress")}},[t]),f=(0,a.useCallback)(()=>{try{let e=localStorage.getItem("ntu-workflow-state");if(e){let r=JSON.parse(e);delete r[t],localStorage.setItem("ntu-workflow-state",JSON.stringify(r))}}catch(e){console.error("Failed to clear workflow state:",e)}},[t]),m=(0,a.useCallback)(()=>{try{let e=localStorage.getItem("ntu-workflow-state");if(e)return JSON.parse(e)[t]||null}catch(e){console.error("Failed to load workflow state:",e)}return null},[t]);return(0,a.useEffect)(()=>{let e=JSON.stringify({currentStep:n,data:l});return e!==c.current&&(u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{d({id:t,type:r,currentStep:n,totalSteps:s,data:l,lastSaved:new Date().toISOString()}),c.current=e},i)),()=>{u.current&&clearTimeout(u.current)}},[t,r,n,s,l,i,d]),{saveWorkflowState:d,clearWorkflowState:f,loadWorkflowState:m}}({workflowId:r||"",workflowType:i,currentStep:u,totalSteps:f,data:p}),v=function(){let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(!1),s=(0,a.useCallback)((e,t,r,n)=>({id:"error-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e,message:t,step:r,timestamp:new Date().toISOString(),recoverable:"permission"!==e,retryCount:0,maxRetries:"network"===e?3:"processing"===e?2:1,context:n}),[]),l=(0,a.useCallback)(e=>{t(t=>[...t,e]),o.Am.error("Error in ".concat(e.step,": ").concat(e.message),{duration:5e3,id:e.id})},[]),i=(0,a.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e)),o.Am.dismiss(e)},[]),c=(0,a.useCallback)(async(r,a)=>{let s=e.find(e=>e.id===r);if(!s||s.retryCount>=s.maxRetries)return!1;n(!0);try{return t(e=>e.map(e=>e.id===r?{...e,retryCount:e.retryCount+1}:e)),await a(),i(r),o.Am.success("Retry successful for ".concat(s.step)),!0}catch(n){let e={...s,retryCount:s.retryCount+1,message:n instanceof Error?n.message:"Retry failed"};return t(t=>t.map(t=>t.id===r?e:t)),e.retryCount>=e.maxRetries&&o.Am.error("Max retries reached for ".concat(s.step)),!1}finally{n(!1)}},[e,i]),u=(0,a.useCallback)((e,t,r,n,a)=>{let o=[];return e.recoverable&&e.retryCount<e.maxRetries&&o.push({type:"retry",label:"Retry (".concat(e.retryCount,"/").concat(e.maxRetries,")"),description:"Try the failed step again",handler:()=>c(e.id,t),primary:!0}),o.push({type:"rollback",label:"Go Back",description:"Return to the previous step",handler:r}),n&&"validation"!==e.type&&o.push({type:"skip",label:"Skip Step",description:"Continue without completing this step",handler:()=>{i(e.id),n()}}),o.push({type:"exit",label:"Exit Workflow",description:"Cancel and return to dashboard",handler:()=>{a&&a(),i(e.id)}}),o},[c,i]),d=(0,a.useCallback)(async(e,t,r)=>{try{let t=await e();return{success:!0,data:t}}catch(o){let e="unknown",n="An unexpected error occurred";o instanceof Error&&(e=(n=o.message).includes("network")||n.includes("fetch")?"network":n.includes("timeout")?"timeout":n.includes("permission")||n.includes("unauthorized")?"permission":n.includes("validation")||n.includes("invalid")?"validation":"processing");let a=s(e,n,t,r);return l(a),{success:!1,error:a}}},[s,l]),f=(0,a.useCallback)(()=>{e.forEach(e=>o.Am.dismiss(e.id)),t([])},[e]),m=(0,a.useCallback)(()=>{let t=e.length,r=e.filter(e=>!e.recoverable||e.retryCount>=e.maxRetries).length;return{total:t,critical:r,retryable:e.filter(e=>e.recoverable&&e.retryCount<e.maxRetries).length,hasErrors:t>0,canProceed:0===r}},[e]);return{errors:e,isRecovering:r,addError:l,removeError:i,retryError:c,getErrorActions:u,handleAsyncOperation:d,clearAllErrors:f,getErrorSummary:m,createError:s}}(),E=(0,a.useCallback)((e,t,r)=>{l(e),c(t),b(r),m(r.length),d(0),y({}),h(!1),v.clearAllErrors()},[v]),x=(0,a.useCallback)(()=>{u<f-1&&d(e=>e+1)},[u,f]),R=(0,a.useCallback)(()=>{u>0&&d(e=>e-1)},[u]),A=(0,a.useCallback)(e=>{y(t=>({...t,...e}))},[]),O=(0,a.useCallback)(()=>{r&&S(),l(null),c(""),d(0),m(0),y({}),b([]),h(!1),v.clearAllErrors()},[r,S,v]),N=(0,a.useCallback)(()=>{O()},[O]),I={currentWorkflow:r,currentStep:u,totalSteps:f,workflowData:p,isLoading:k,startWorkflow:E,nextStep:x,previousStep:R,updateWorkflowData:A,finishWorkflow:O,cancelWorkflow:N,resumeWorkflow:(0,a.useCallback)(e=>{l(e.id),c(e.type),d(e.currentStep),m(e.totalSteps),y(e.data)},[]),steps:w,errors:v.errors,isRecovering:v.isRecovering,handleAsyncOperation:v.handleAsyncOperation,addError:v.addError,removeError:v.removeError,clearAllErrors:v.clearAllErrors,getErrorSummary:v.getErrorSummary};return(0,n.jsx)(s.Provider,{value:I,children:t})}function i(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useWorkflow must be used within a WorkflowProvider");return e}},8483:function(e,t,r){"use strict";r.d(t,{Providers:function(){return f}});var n=r(7437),a=r(1800),o=r(9827),s=r(5922),l=r(6175),i=r(2265),c=r(9376),u=r(2935);let d=new a.S;function f(e){let{children:t}=e;return!function(){let e=(0,c.useRouter)();(0,i.useEffect)(()=>{function t(t){(t.metaKey||t.ctrlKey)&&"m"===t.key&&(t.preventDefault(),e.push("/"))}return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e])}(),(0,n.jsx)(o.aH,{client:d,children:(0,n.jsx)(s.f,{attribute:"class",defaultTheme:"system",enableSystem:!0,disableTransitionOnChange:!0,children:(0,n.jsxs)(u.b,{children:[(0,n.jsx)(l.x7,{position:"bottom-right"}),t]})})})}},2778:function(){}},function(e){e.O(0,[635,175,694,971,117,744],function(){return e(e.s=1627)}),_N_E=e.O()}]);